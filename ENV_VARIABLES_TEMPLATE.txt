# ========================================
# BACKEND ENVIRONMENT VARIABLES
# ========================================
# Copy these to Vercel Dashboard when deploying backend
# Project Settings → Environment Variables

MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/database?retryWrites=true&w=majority
JWT_SECRET=generate_a_random_string_minimum_32_characters_long
NODE_ENV=production

# How to get MongoDB URI:
# 1. Go to MongoDB Atlas: https://cloud.mongodb.com
# 2. Click "Connect" on your cluster
# 3. Choose "Connect your application"
# 4. Copy the connection string
# 5. Replace <username>, <password>, and <database> with your values

# How to generate JWT_SECRET:
# Run the prepare-deploy.ps1 script, it will generate one for you
# Or use: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"


# ========================================
# FRONTEND ENVIRONMENT VARIABLES
# ========================================
# Copy these to Vercel Dashboard when deploying frontend
# Project Settings → Environment Variables

NEXT_PUBLIC_API_URL=https://your-backend-url.vercel.app/api

# Replace "your-backend-url" with the actual URL from your deployed backend
# Example: https://my-auth-backend.vercel.app/api
# DO NOT include trailing slash


# ========================================
# MONGODB ATLAS SETUP
# ========================================
# Required steps after deployment:

# 1. Network Access:
#    - Go to: Security → Network Access
#    - Click: Add IP Address
#    - Select: Allow Access from Anywhere (0.0.0.0/0)
#    - Click: Confirm
#    
#    This is required because Vercel uses dynamic IP addresses

# 2. Database Access:
#    - Go to: Security → Database Access
#    - Verify your user has "Read and write to any database" permission
#    - If not, edit the user and grant permission


# ========================================
# VERIFICATION CHECKLIST
# ========================================

# Backend Deployment:
# ✓ MONGODB_URI is set in Vercel
# ✓ JWT_SECRET is set in Vercel
# ✓ NODE_ENV is set to "production"
# ✓ Backend URL accessible (returns JSON message)

# Frontend Deployment:
# ✓ NEXT_PUBLIC_API_URL is set in Vercel
# ✓ Points to correct backend URL + /api
# ✓ Frontend loads without errors

# MongoDB:
# ✓ Network access allows 0.0.0.0/0
# ✓ Database user has read/write permissions
# ✓ Connection string is correct

# Testing:
# ✓ Can sign up new user
# ✓ Can log in
# ✓ Dashboard loads
# ✓ Can create items
# ✓ Admin features work (if admin user)


# ========================================
# TROUBLESHOOTING
# ========================================

# Issue: "Cannot connect to MongoDB"
# Solution: Check MongoDB Atlas network access, add 0.0.0.0/0

# Issue: "JWT malformed" or "Invalid token"
# Solution: Verify JWT_SECRET is set correctly in backend

# Issue: "CORS error" in browser
# Solution: Backend CORS is configured, redeploy backend

# Issue: "Failed to fetch" from frontend
# Solution: Check NEXT_PUBLIC_API_URL is correct, must end with /api

# Issue: "Build failed" on Vercel
# Solution: Check logs, ensure package.json is correct, try clearing cache
